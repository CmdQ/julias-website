---
import '../styles/global.css';

interface AlternateLinks {
	en?: string;
	de?: string;
}

interface Props {
	lang: 'en' | 'de';
	title: string;
	description?: string;
	alternates?: AlternateLinks;
}

const siteName = "Julia's Portfolio";
const { lang, title, description, alternates = {} }: Props = Astro.props;
const pageTitle = title ? `${title} ¬∑ ${siteName}` : siteName;

const localeNav = {
	en: [
		{ href: '/en/', label: 'Home' },
		{ href: '/en/about-me/', label: 'About me' },
		{ href: '/en/contact/', label: 'Contact' },
		{ href: '/en/project-futopia/', label: 'Project Futopia' },
		{ href: '/en/climate-education/', label: 'Climate Education' },
		{ href: '/en/creative-projects/', label: 'Creative Projects' },
	],
	de: [
		{ href: '/de/', label: 'Home' },
		{ href: '/de/about-me/', label: 'About me' },
		{ href: '/de/contact/', label: 'Kontakt' },
		{ href: '/de/project-futopia/', label: 'Projekt Futopia' },
		{ href: '/de/climate-education/', label: 'Climate Education' },
		{ href: '/de/creative-projects/', label: 'Kreative Projekte' },
	],
} as const;

const navItems = localeNav[lang];
const otherLocale = lang === 'en' ? 'de' : 'en';
const switchHref = alternates[otherLocale] ?? `/${otherLocale}/`;
const canonical = Astro.site ? new URL(Astro.url.pathname, Astro.site).toString() : undefined;
const currentPath = Astro.url.pathname;

// Build hreflang alternates
const hreflangAlternates = {
	en: alternates.en ?? '/en/',
	de: alternates.de ?? '/de/',
};
---
<!DOCTYPE html>
<html lang={lang} class="min-h-full">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="generator" content={Astro.generator} />
		<title>{pageTitle}</title>
		{canonical && <link rel="canonical" href={canonical} />}
		{description && <meta name="description" content={description} />}
		{Object.entries(hreflangAlternates).map(([locale, href]) => (
			<link rel="alternate" hreflang={locale} href={href} />
		))}
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
	</head>
	<body class="min-h-screen" style="background-color: black;">
		<div class="mx-auto max-w-5xl" style="background-color: var(--color-bg-cream);">

		<!-- Hero Image - scrolls away -->
		<div class="relative w-full overflow-hidden">
			<img
				src="/images/hero.png"
				alt="Julia Salomon - Educator and Artist"
				class="w-full h-auto"
			/>
		</div>

		<!-- Sticky Navigation -->
		<header class="sticky top-0 z-40" style="background-color: var(--color-highlight);">
			<div class="flex w-full flex-col gap-6 px-6 py-8 sm:flex-row sm:items-end sm:justify-between">
			<div>
					<p class="text-sm uppercase tracking-[0.2em] font-bold" style="color: var(--color-text-dark); opacity: 0.7;">{lang === 'en' ? "Educator & Artist" : 'P√§dagogin & K√ºnstlerin'}</p>
					<h1 class="m-0 text-4xl font-black drop-shadow-sm" style="color: var(--color-text-dark);">Julia Salomon</h1>
				</div>
				<nav aria-label={lang === 'en' ? 'Primary' : 'Hauptnavigation'} class="grid grid-cols-2 gap-3 text-base sm:grid-cols-3 sm:gap-4">
					{navItems.map((item) => {
						const isActive = currentPath === item.href || currentPath === item.href.replace(/\/$/, '');
						return (
						<a
							class="group rounded-xl px-4 py-3 text-center font-bold transition-all duration-300 hover:scale-105 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 border backdrop-blur-sm"
							style={isActive
								? "color: var(--color-text-dark); border-color: var(--color-text-dark); background-color: color-mix(in srgb, var(--color-white) 70%, transparent); --tw-ring-color: var(--color-text-dark);"
								: "color: var(--color-text-dark); border-color: color-mix(in srgb, var(--color-text-dark) 20%, transparent); background-color: color-mix(in srgb, var(--color-white) 30%, transparent); --tw-ring-color: var(--color-text-dark);"}
							href={item.href}
							aria-current={isActive ? 'page' : undefined}
						>
							{item.label}
						</a>
					)})}
				</nav>
			</div>
		</header>
		<main id="main-content" class="w-full px-6 py-12 sm:px-12">
			<slot />
		</main>
		<footer style="background-color: var(--color-bg-cream);">
			<div class="flex w-full flex-col gap-4 px-6 py-8 sm:flex-row sm:items-center sm:justify-between">
				<p class="m-0 text-sm" style="color: var(--color-text-dark); opacity: 0.7;">¬© {new Date().getFullYear()} Julia Salomon</p>
				<div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-6">
					<a class="text-sm font-semibold hover:underline" style="color: var(--color-text-dark);" href={lang === 'en' ? '/en/privacy/' : '/de/privacy/'}>
						{lang === 'en' ? 'Privacy Notice' : 'Datenschutz'}
					</a>
					<a class="inline-flex items-center gap-2 text-sm font-semibold" style="color: var(--color-text-dark);" href={switchHref}>
						<span aria-hidden="true">üåê</span>
						{lang === 'en' ? 'Deutsch' : 'English'}
					</a>
				</div>
			</div>
		</footer>
		</div>
	</body>
</html>
